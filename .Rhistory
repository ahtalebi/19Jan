library(tidyverse)
library(dplyr)
library(ggplot2)
insurance <- read.csv("/home/amir/Documents/3rd_semester/workshop I/project/project_R/insurance.csv", header = TRUE)
insurance
summary(insurance[c('age', 'bmi', 'children', 'charges')])
sapply(insurance, class)
# to check for the outliers
for (i in 1:ncol(insurance)) {
if (is.numeric(insurance[, i])) {
boxplot(insurance[, i], outcol="Red", main=colnames(insurance)[i])
}
}
# to check for null values per column
colSums(is.na(insurance))
sum(duplicated(insurance))
insurance <- unique(insurance)
insurance
ggplot(insurance, aes(x = charges)) +
geom_histogram(binwidth = 1500, fill = 'lightgreen', color = 'black') +
labs(title='charges distribution', x = 'charges') +
theme_minimal()
hist(insurance$age, main='Age distribution', xlab='Age', col='lightblue', border='black', breaks=15  , prob=TRUE)
lines(density(insurance$age), col = 'red')
insurance$sex <- as.factor(insurance$sex)
ggplot(insurance, aes(x=sex, fill=sex, group=sex)) +
geom_bar() +
theme_minimal() +
scale_fill_manual(values=c('cyan', 'brown'))
hist(insurance$bmi, main='BMI distribution', xlab='BMI', col='lightgreen', border='black', breaks=15 , prob=TRUE)
lines(density(insurance$bmi), col = 'red')
ggplot(insurance, aes(x=children)) +
geom_bar(fill='lightblue', color='black') +
labs(title='Children counter', x='children') +
theme_minimal()
insurance$region <- as.factor(insurance$region)
ggplot(insurance, aes(x=region, fill=region)) +
geom_bar(alpha=2.7) +
labs(title='Region distribution') +
theme_minimal()
# group data by sex.
grouped_insurance_df <- insurance %>%
group_by(sex)
summary_statistics <- grouped_insurance_df %>%
summarise(
min_charges = min(charges),
max_charges = max(charges),
mean_charges = mean(charges),
count_charges = n(),
std_charges = sd(charges)
)
print(summary_statistics)
